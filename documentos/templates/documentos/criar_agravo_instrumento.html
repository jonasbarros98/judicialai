{% extends 'documentos/base.html' %}
{% load static %}

{% block title %}Criar Agravo de Instrumento{% endblock %}

{% block content %}

<div class="container mt-5">
    <h2 class="text-center">Criar Agravo de Instrumento</h2>
    <br>
    <form method="post" action="{% url 'criar_agravo_instrumento' %}" id="documento-form">
        {% csrf_token %}

        <div class="form-group">
            <label for="processo_numero" class="required-field">Número do Processo:</label>
            <input 
                type="text" 
                class="form-control" 
                name="processo_numero" 
                id="processo_numero" 
                placeholder="Ex: XXXXXXX-XX.2024.1.23.4567" 
                required>
        </div>

        <div class="form-group">
            <label for="fundamentacao_direito" class="required-field">Fundamentação Jurídica:</label>
            <textarea 
                class="form-control" 
                name="fundamentacao_direito" 
                id="fundamentacao_direito" 
                rows="5" 
                placeholder="Descreva detalhadamente os fundamentos jurídicos que embasam o agravo de instrumento." 
                required></textarea>
        </div>

        <div class="form-group">
            <label for="pedido" class="required-field">Pedido:</label>
            <textarea 
                class="form-control" 
                name="pedido" 
                id="pedido" 
                rows="3" 
                placeholder="Informe o pedido principal e os pedidos alternativos, se houver." 
                required></textarea>
        </div>

        <div class="form-group">
            <label for="valor_causa" class="required-field">Valor da Causa:</label>
            <input 
                type="text" 
                class="form-control" 
                name="valor_causa" 
                id="valor_causa" 
                placeholder="Ex: R$ 50.000,00" 
                required>
        </div>

        <div class="form-group">
            <label for="juizo_competente" class="required-field">Juízo Competente:</label>
            <input 
                type="text" 
                class="form-control" 
                name="juizo_competente" 
                id="juizo_competente" 
                placeholder="Ex: Tribunal de Justiça de São Paulo" 
                required>
        </div>

        <div class="form-group">
            <label for="provas">Provas:</label>
            <textarea 
                class="form-control" 
                name="provas" 
                id="provas" 
                rows="3" 
                placeholder="Liste as provas anexadas ao agravo, como documentos, declarações ou e-mails relevantes."></textarea>
        </div>

        <button type="submit" class="btn btn-primary">Gerar Agravo de Instrumento</button>
    </form>

    {% if error_message %}
        <div class="alert alert-danger mt-3">{{ error_message }}</div>
    {% endif %}
</div>

<script src="{% static 'js/vanilla-masker.min.js' %}"></script>
<script>
     //////////////////////////////////////////////////////////////////////////////////////////

     document.addEventListener('DOMContentLoaded', function () {
        //Aplicando a máscara
        var valorCausaInput = document.getElementById('valor_causa');
        VMasker(valorCausaInput).maskMoney({
            precision: 2,
            separator: ',',
            delimiter: '.',
            unit: 'R$ ',
            zeroCents: false
        });

         // Remove a máscara antes de submeter o formulário
         document.getElementById('documento-form').addEventListener('submit', function (event) {
            // Remove a máscara e converte para formato numérico
            var valorCausaRaw = valorCausaInput.value.replace(/[R$\s.]/g, '').replace(',', '.');
            valorCausaInput.value = valorCausaRaw;

            console.log('Valor da Causa Formatado:', valorCausaRaw); // Verifica no console
        });


    });

</script>

{% endblock %}
