{% extends 'documentos/base.html' %}
{% load static %}

{% block title %}Documento Criado com Sucesso{% endblock %}

{% block contentSucesso %}

<!-- Aplicando o fundo à página inteira -->
<style>
    body {
        background-color: #f8f9fa;
    }

    /* Alinhando os elementos usando o grid do Bootstrap */
    .container-fluid {
        margin-top: 30px;
    }

    .action-links {
        margin-bottom: 15px;
    }

    /* Adicionando um pouco de estilo extra para os botões na sidebar */
    .btn-block {
        width: 100%;
        margin-bottom: 10px;
    }

    .ajuste {
    max-width: 90%;
    /* Ajuste a largura conforme necessário */
    margin: 10px auto 20px auto;
    /* Suba o container e centraliza horizontalmente */
    padding: 20px;
    /* Adicione padding para espaçamento interno */

    background-color: #f5f5f521;
    /* Fundo branco com 80% de opacidade */
    border-radius: 8px;
    /* Bordas arredondadas para um visual mais suave */
    box-shadow: 0 0px 1px rgba(0, 0, 0, 0.1);
    /* Sombra para dar profundidade */
}
.containerTopo {
    margin-top: 30px;
    width: 100%;
    /* Ajuste a largura conforme necessário */
   
    margin-left: auto;
    /* Centralize o container horizontalmente */
    margin-right: auto;
    /* Centralize o container horizontalmente */
    padding: 20px;
    /* Adicione padding para espaçamento interno */
}
</style>

<div class="container-fluid ajuste">
    <div class="row">
        <!-- Sidebar com os botões de ação -->
        <div class="col-md-2">
            <h4>Opções</h4>
            <div class="action-links">
                <form method="post" action="{% url 'editar_documento' documento.id %}" onsubmit="return updateEditorContent();">
                    {% csrf_token %}
                    <!-- Campo oculto para enviar o conteúdo editado -->
                    <input type="hidden" name="conteudo_documento_hidden" id="conteudo_documento_hidden">
                    <button type="submit" class="btn btn-primary btn-block">Salvar Alterações</button>
                    <a href="{% url 'exportar_documento_pdf' documento.id %}" class="btn btn-secondary btn-block">Baixar PDF</a>
                    <a href="{% url 'exportar_documento_word' documento.id %}" class="btn btn-success btn-block">Baixar Word</a>
                </form>
                <a href="{% url 'tela_inicial' %}" class="btn btn-secondary btn-block">Criar outro documento</a>
            </div>
        </div>

        <!-- Conteúdo principal -->
        <div class="col-md-10">
            <div class="container">
                <h2 class="text-center text-dark">Documento Criado com Sucesso!</h2>
                <p class="text-center text-secondary">O resultado poderá ser salvo ou editado abaixo</p>
                 <!-- Informações principais do documento 
                            <div class="mb-3">
                                <strong>Tipo de Ação:</strong> {{ documento.tipo }}<br>
                                <strong>Valor da Causa:</strong> R$ {{ documento.valor_causa }}<br>
                                <strong>Juízo Competente:</strong> {{ documento.juizo_competente }}<br>
                            </div>-->
            </div>
            <div class="card container mt-1">
                <div class="card-body">
                   <!-- <h2 class="text-center text-dark">Documento Criado com Sucesso!</h2>
                    <p class="text-center text-secondary">O resultado poderá ser salvo ou editado abaixo</p>-->

                    <div class="editable-content">
                        <!-- Formulário para editar o conteúdo 
                        <form method="post" action="{% url 'editar_documento' documento.id %}" onsubmit="return updateEditorContent();">
                            {% csrf_token %}-->
                            
                            
                            
                            <!-- Conteúdo editável com CKEditor -->
                            <div id="conteudo_documento" contenteditable="true">
                                {{ documento.conteudo | safe }}
                            </div>
                       <!-- </form>-->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Inicializa o CKEditor -->
<script src="{% static 'ckeditor/ckeditor/ckeditor.js' %}"></script>
<script>
    // Configura CKEditor na div com o ID 'conteudo_documento'
   /* var editor = CKEDITOR.inline('conteudo_documento', {
        removePlugins: 'notificationMessage'
    });

    // Função para capturar o conteúdo do CKEditor e inseri-lo no campo oculto ao submeter o formulário
    function updateEditorContent() {
        var content = editor.getData();
        alert(content);
        document.getElementById('conteudo_documento_hidden').value = content;
        return true;
    }*/

    // Configura CKEditor na div com o ID 'conteudo_documento'
    var editor = CKEDITOR.inline('conteudo_documento', {
        removePlugins: 'notificationMessage'
    });

    // Função para capturar o conteúdo do CKEditor e inseri-lo no campo oculto ao submeter o formulário
    function updateEditorContent() {
        var content = editor.getData();
        console.log("Conteúdo do CKEditor:", content);  // Debug: Mostra o conteúdo capturado do CKEditor
        document.getElementById('conteudo_documento_hidden').value = content;
        //alert(document.getElementById('conteudo_documento_hidden').value);
        return true;
    }
</script>

{% endblock %}
